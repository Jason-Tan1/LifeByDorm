# ==============================================================================
# Development Dockerfile for LifeByDorm
# Used for local development with hot-reloading and database seeding
# Build context: project root (parent of client/ and server/)
# ==============================================================================

FROM node:20-alpine
WORKDIR /app

# Install dependencies for native modules
RUN apk add --no-cache python3 make g++

# Copy frontend package files and install
COPY client/package.json client/package-lock.json* ./client/
RUN cd client && npm ci --legacy-peer-deps

# Copy server package files and install
COPY server/package.json server/package-lock.json* ./server/
RUN cd server && npm ci --legacy-peer-deps

# Copy source code
COPY . .

# Expose ports
EXPOSE 5173 3000

# Default command (can be overridden)
CMD ["npm", "run", "dev"]
